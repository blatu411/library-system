# Phase 3 现场功能测试计划 🧪

## 🎯 测试目标
验证所有新增功能的完整性和正确性，确保系统稳定可靠。

## 📝 测试清单

### 1️⃣ 首页功能测试 (http://localhost:3000)

#### ✅ 基础功能
- [ ] 页面正常加载，显示所有内容
- [ ] 导航栏显示正确，包含3个链接（首页/借阅记录/统计看板）
- [ ] 当前页面导航链接高亮为蓝色
- [ ] 响应式设计：桌面端显示水平导航，手机端显示汉堡菜单

#### ✅ 图书列表功能
- [ ] 图书列表正常加载显示所有图书
- [ ] 每本书显示：书名、作者、状态（在馆/借出）
- [ ] 状态徽章颜色正确：绿色=在馆，红色=借出
- [ ] 在馆图书显示"借阅"按钮，借出图书显示"还书"按钮

#### ✅ 搜索功能
- [ ] 搜索框可输入（默认为空）
- [ ] 输入图书名称（如"红楼梦"）：列表立即筛选，只显示匹配的图书
- [ ] 输入作者名称（如"曹雪芹"）：列表显示该作者的图书
- [ ] 清空搜索框：列表恢复显示所有图书
- [ ] 防抖生效：输入时不会产生多次请求

#### ✅ 状态筛选功能
- [ ] 4个筛选按钮：全部、在馆、借出、丢失
- [ ] 点击"在馆"：只显示状态为"在馆"的图书
- [ ] 点击"借出"：只显示状态为"借出"的图书
- [ ] 点击"全部"：显示所有图书
- [ ] 搜索和筛选可组合：既能按状态筛选又能同时搜索

#### ✅ 借阅弹窗功能
- [ ] 点击"借阅"按钮：弹出借阅弹窗
- [ ] 弹窗显示书名、读者列表、期限选项、应还日期
- [ ] 期限选项：7天、14天、30天、自定义
- [ ] 选择不同期限：预计归还日期自动更新
- [ ] 选择"自定义日期"：显示日期选择器
- [ ] 必须选择读者才能提交
- [ ] 点击"确认借阅"：提交成功，弹窗关闭，列表更新，显示成功提示

#### ✅ 还书功能
- [ ] 点击"还书"按钮：提交成功，图书状态变为"在馆"
- [ ] 显示成功提示："还书成功！"
- [ ] 列表自动刷新

#### ✅ 读者列表功能
- [ ] 读者列表正常加载显示所有读者
- [ ] 每个读者卡片显示读者名称
- [ ] **关键测试：点击读者卡片→跳转到该读者的历史页面**

---

### 2️⃣ 借阅记录页测试 (http://localhost:3000/loans)

#### ✅ 页面加载
- [ ] 页面正常加载，标题显示"📋 借阅记录"
- [ ] 导航栏"借阅记录"链接高亮
- [ ] 搜索框和筛选按钮正常显示

#### ✅ 表格显示 (桌面端)
- [ ] 表格显示所有列：图书名、读者名、借阅日期、应还日期、归还日期、状态、剩余天数
- [ ] 表格行可悬停，背景变亮
- [ ] 每行显示完整信息

#### ✅ 卡片显示 (移动端)
- [ ] 在手机尺寸下，表格自动转换为卡片布局
- [ ] 每张卡片显示关键信息：书名、读者、日期、状态
- [ ] 卡片排列整齐，间距合理

#### ✅ 搜索功能
- [ ] 输入图书名称：只显示匹配的记录
- [ ] 输入读者名称：只显示该读者的记录
- [ ] 清空搜索框：恢复显示所有记录
- [ ] 防抖优化生效

#### ✅ 状态筛选
- [ ] 4个筛选按钮：全部、进行中、已归还、逾期
- [ ] "进行中"：显示return_date为null的记录
- [ ] "已归还"：显示return_date不为null的记录
- [ ] "逾期"：显示due_date早于今天且return_date为null的记录
- [ ] "全部"：显示所有记录
- [ ] 清空筛选按钮：重置搜索和筛选

#### ✅ 分页功能
- [ ] 显示分页信息："第 X 页 / 共 Y 页 (共 Z 条记录)"
- [ ] 如果记录超过10条，显示分页按钮
- [ ] 点击页码按钮：跳转到对应页面
- [ ] 上一页/下一页按钮正常工作
- [ ] URL更新：?q=xxx&status=xxx&page=N

#### ✅ 读者链接
- [ ] 读者名称显示为蓝色链接
- [ ] **关键测试：点击读者名称→跳转到该读者的历史页面**

---

### 3️⃣ 读者历史页测试 (http://localhost:3000/readers/1)

#### ✅ 页面加载
- [ ] 页面正常加载
- [ ] 显示读者基本信息：读者名称、读者ID
- [ ] 导航栏有返回按钮，点击返回借阅记录页

#### ✅ 统计数据显示
- [ ] 显示4个统计卡片：
  - 总借阅次数（蓝色）
  - 当前借阅（橙色）
  - 已归还（绿色）
  - 逾期次数（红色）
- [ ] 数据正确：总借阅 = 当前借阅 + 已归还 + 逾期次数
- [ ] 数值显示合理（非负数）

#### ✅ 借阅历史时间线
- [ ] 按借阅日期倒序排列（最新的在前）
- [ ] 每条记录显示：
  - 圆点（进行中=橙色，已归还=绿色，逾期=红色）
  - 图书名称
  - 借阅日期、应还日期、归还日期
  - 状态徽章
- [ ] 逾期记录：应还日期显示为红色，显示"⚠️ 该书已逾期，请尽快归还"
- [ ] 已归还记录：显示"✅ 已于 XXXX-XX-XX 成功归还"

#### ✅ 响应式设计
- [ ] 桌面端：时间线正常显示，布局整齐
- [ ] 手机端：时间线压缩，仍然可读

#### ✅ 导航测试
- [ ] 点击返回按钮：返回借阅记录页
- [ ] 浏览器后退：返回上一个页面

---

### 4️⃣ 统计看板页测试 (http://localhost:3000/statistics)

#### ✅ 页面加载
- [ ] 页面正常加载，标题显示"📊 统计看板"
- [ ] 导航栏"统计看板"链接高亮
- [ ] 所有数据加载完成

#### ✅ 统计卡片显示
- [ ] 显示4个统计卡片，从左到右：
  1. 图书总数 (📚 icon)
  2. 读者总数 (👥 icon)
  3. 当前借出 (📤 icon)
  4. 总借阅次数 (📋 icon)
- [ ] 每个卡片显示：icon、标题、数值
- [ ] 卡片有渐变背景，颜色各不相同
- [ ] 响应式设计：
  - 桌面：4列并排
  - 平板：2列
  - 手机：1列堆叠

#### ✅ 活跃读者排行
- [ ] 显示标题："🏆 活跃读者排行 (Top 10)"
- [ ] 显示最多10个读者，按借阅次数从高到低排序
- [ ] 每个读者显示：
  - 排行号 (1、2、3...)
  - 读者名称
  - 借阅次数
  - 水平条形图（填充百分比表示相对排名）
- [ ] 条形图颜色各不相同（渐变色）
- [ ] 如果没有数据显示"暂无数据"

#### ✅ 热门图书排行
- [ ] 显示标题："⭐ 热门图书排行 (Top 10)"
- [ ] 显示最多10本图书，按借阅次数从高到低排序
- [ ] 每本书显示：
  - 排行号 (1、2、3...)
  - 图书名称
  - 借阅次数
  - 水平条形图
- [ ] 条形图颜色各不相同（渐变色）
- [ ] 长图书名称截断显示，不换行

#### ✅ 响应式设计
- [ ] 桌面：两个排行榜并排显示
- [ ] 平板/手机：排行榜堆叠显示
- [ ] 所有元素在小屏幕上可读

---

### 5️⃣ 导航栏功能测试

#### ✅ 桌面端导航（≥768px）
- [ ] 显示水平导航：首页、借阅记录、统计看板
- [ ] 当前页面链接高亮为蓝色背景
- [ ] 其他链接显示灰色，悬停时变深
- [ ] 点击链接正常导航

#### ✅ 移动端导航（<768px）
- [ ] 显示汉堡菜单按钮（三条横线）
- [ ] 点击汉堡菜单：展开菜单，显示3个链接
- [ ] 菜单项排列纵向，宽度充满屏幕
- [ ] 点击菜单项：导航到对应页面，菜单自动关闭
- [ ] 再次点击汉堡菜单：菜单关闭

#### ✅ 导航一致性
- [ ] 所有页面导航栏显示一致
- [ ] logo和标题显示正确
- [ ] 导航链接在所有页面都可用

---

## 🔍 数据完整性检查

### 验证借阅流程
```
1. 首页借阅 → /loans页面查看 → 读者历史页验证
2. 验证数据同步：新借阅在/loans页面显示
3. 验证读者统计：当前借阅数增加
```

### 验证归还流程
```
1. 首页还书 → /loans页面查看 → 读者历史页验证
2. 验证数据同步：记录状态变为"已归还"
3. 验证读者统计：当前借阅数减少，已归还增加
```

### 验证统计数据准确性
```
1. 总借阅次数 = loans表的总行数
2. 当前借出 = return_date为null的记录数
3. 读者总数 = readers表的总行数
4. 图书总数 = books表的总行数
5. 活跃读者排行 = 按reader_id分组计数，按count降序
6. 热门图书排行 = 按book_id分组计数，按count降序
```

---

## ⚠️ 边界情况测试

### 空数据测试
- [ ] 如果没有图书：显示"暂无图书"
- [ ] 如果没有读者：显示"暂无读者"
- [ ] 如果没有借阅记录：显示"暂无借阅记录"

### 搜索边界
- [ ] 搜索词为空：显示所有数据
- [ ] 搜索不存在的内容：显示"搜索结果为空"
- [ ] 搜索包含特殊字符：正常处理

### 日期边界
- [ ] 应还日期 = 今天：显示"0天"
- [ ] 应还日期 < 今天且未归还：显示为逾期
- [ ] 自定义日期必须 ≥ 今天

### 分页边界
- [ ] 只有1页：不显示分页按钮
- [ ] 在第一页：上一页按钮不可用/隐藏
- [ ] 在最后一页：下一页按钮不可用/隐藏

---

## 📱 响应式设计验证

### 桌面端 (1920px+)
- [ ] 页面布局最宽
- [ ] 表格完整显示所有列
- [ ] 导航水平显示

### 平板端 (768px - 1024px)
- [ ] 内容自适应，仍然可读
- [ ] 表格列可能部分隐藏或缩小
- [ ] 卡片适配宽度

### 手机端 (320px - 480px)
- [ ] 所有内容单列显示
- [ ] 表格转换为卡片布局
- [ ] 导航为汉堡菜单
- [ ] 触摸目标足够大（44px最小）

---

## ✅ 最终验收标准

### 功能完整性
- [ ] 所有5个路由均可访问
- [ ] 所有搜索和筛选功能正常
- [ ] 所有链接导航正确
- [ ] 所有数据显示准确

### 用户体验
- [ ] 页面加载速度快（<2秒）
- [ ] 交互响应及时
- [ ] 错误提示清晰
- [ ] 移动端友好

### 代码质量
- [ ] 无JavaScript错误
- [ ] 无TypeScript错误
- [ ] 控制台无警告
- [ ] 页面性能良好

---

## 📝 测试指南

开发服务器已在 http://localhost:3000 运行

### 按顺序测试：
1. **首页** → 测试所有基础功能
2. **借阅记录** → 测试搜索、筛选、分页
3. **读者历史** → 点击读者卡片或列表中的读者名
4. **统计看板** → 验证所有统计数据
5. **导航栏** → 在各页面间切换，验证高亮

### 记录问题：
- 如发现任何问题，请记录：
  - 问题描述
  - 重现步骤
  - 预期结果 vs 实际结果

---

## 🎯 成功标准

所有项目都勾选 ✅ 时，Phase 3 验收通过！
